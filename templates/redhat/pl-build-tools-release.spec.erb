Name:           <%= @name %>
Version:        <%= @version %>
Release:        <%= @release %>
Summary:        Configuration for yum.puppetlabs.com

Group:          System Environment/Base
License:        ASL 2.0

# This is a Puppet Labs maintained package which is specific to
# our distribution.  Thus the source is only available from
# within this srpm.
URL:            http://pl-build-tools.puppetlabs.net
Source0:        http://yum.puppetlabs.com/RPM-GPG-KEY-puppetlabs
Source1:        pl-build-tools-release.repo

BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

BuildArch:      noarch
Requires:       redhat-release >=  %{version}

%description
This package contains the yum.puppetlabs.com repository
GPG key as well as configuration for a yum client.

%prep
%setup -q  -c -T
install -pm 644 %{SOURCE0} .
install -pm 644 %{SOURCE1} .

%build

%install
rm -rf $RPM_BUILD_ROOT

#GPG Key
install -Dpm 644 %{SOURCE0} \
    $RPM_BUILD_ROOT%{_sysconfdir}/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs

# yum
install -dm 755 $RPM_BUILD_ROOT%{_sysconfdir}/yum.repos.d
install -pm 644 %{SOURCE1}  \
    $RPM_BUILD_ROOT%{_sysconfdir}/yum.repos.d

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
%config(noreplace) /etc/yum.repos.d/pl-build-tools-release.repo
%{_sysconfdir}/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs


%changelog
* <%= Time.now.strftime("%a %b %d %Y") %> Puppet Labs Build Tools <info@puppetlabs.com> -  <%= @version %>-<%= @release %>
- Build for <%= @version %>

* Fri Jun 27 2014 Melissa Stone <melissa@puppetlabs.com> -  <%= @version -%>-1
- Initial Package
